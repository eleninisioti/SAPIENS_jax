/Users/enis/miniconda3/envs/GrowAI_framework/lib/python3.11/site-packages/flashbax/buffers/trajectory_buffer.py:473: UserWarning: Setting max_size dynamically sets the `max_length_time_axis` to be `max_size`//`add_batch_size = 10000`.This allows one to control exactly how many timesteps are stored in the buffer.Note that this overrides the `max_length_time_axis` argument.
  warnings.warn(
/Users/enis/miniconda3/envs/GrowAI_framework/lib/python3.11/site-packages/jax/_src/numpy/array_methods.py:69: UserWarning: Explicitly requested dtype <class 'jax.numpy.int64'> requested in astype is not available, and will be truncated to dtype int32. To enable more dtypes, set the jax_enable_x64 configuration option or the JAX_ENABLE_X64 shell environment variable. See https://github.com/google/jax#current-gotchas for more.
  return lax_numpy.astype(arr, dtype, copy=copy, device=device)
/Users/enis/Desktop/workspace/projects/SAPIENS_jax/sapiens/sapiens.py:137: DeprecationWarning: jax.tree_map is deprecated: use jax.tree.map (jax v0.4.25 or newer) or jax.tree_util.tree_map (any JAX version).
  target_network_params=jax.tree_map(lambda x: jnp.copy(x), network_params),
/Users/enis/Desktop/workspace/projects/SAPIENS_jax/sapiens/sapiens.py:208: DeprecationWarning: jax.tree_map is deprecated: use jax.tree.map (jax v0.4.25 or newer) or jax.tree_util.tree_map (any JAX version).
  timestep = jax.tree_map(lambda x: jnp.expand_dims(x,1), timestep)
/Users/enis/Desktop/workspace/projects/SAPIENS_jax/sapiens/sapiens.py:216: DeprecationWarning: jax.tree_map is deprecated: use jax.tree.map (jax v0.4.25 or newer) or jax.tree_util.tree_map (any JAX version).
  exp = jax.tree_map(lambda x: x[:,:config["SHARED_BATCH_SIZE"],...], exp)
/Users/enis/Desktop/workspace/projects/SAPIENS_jax/sapiens/sapiens.py:224: DeprecationWarning: jax.tree_map is deprecated: use jax.tree.map (jax v0.4.25 or newer) or jax.tree_util.tree_map (any JAX version).
  shared_exp = jax.tree_map(lambda x: jnp.reshape(x, (x.shape[0], x.shape[1] * x.shape[2], *x.shape[3:])), shared_exp)
/Users/enis/Desktop/workspace/projects/SAPIENS_jax/sapiens/sapiens.py:225: DeprecationWarning: jax.tree_map is deprecated: use jax.tree.map (jax v0.4.25 or newer) or jax.tree_util.tree_map (any JAX version).
  total_exp = jax.tree_map(lambda x, y: jnp.concatenate([x, y], axis=1),timestep, shared_exp  )
/Users/enis/Desktop/workspace/projects/SAPIENS_jax/sapiens/sapiens.py:208: DeprecationWarning: jax.tree_map is deprecated: use jax.tree.map (jax v0.4.25 or newer) or jax.tree_util.tree_map (any JAX version).
  timestep = jax.tree_map(lambda x: jnp.expand_dims(x,1), timestep)
/Users/enis/Desktop/workspace/projects/SAPIENS_jax/sapiens/sapiens.py:216: DeprecationWarning: jax.tree_map is deprecated: use jax.tree.map (jax v0.4.25 or newer) or jax.tree_util.tree_map (any JAX version).
  exp = jax.tree_map(lambda x: x[:,:config["SHARED_BATCH_SIZE"],...], exp)
/Users/enis/Desktop/workspace/projects/SAPIENS_jax/sapiens/sapiens.py:224: DeprecationWarning: jax.tree_map is deprecated: use jax.tree.map (jax v0.4.25 or newer) or jax.tree_util.tree_map (any JAX version).
  shared_exp = jax.tree_map(lambda x: jnp.reshape(x, (x.shape[0], x.shape[1] * x.shape[2], *x.shape[3:])), shared_exp)
/Users/enis/Desktop/workspace/projects/SAPIENS_jax/sapiens/sapiens.py:225: DeprecationWarning: jax.tree_map is deprecated: use jax.tree.map (jax v0.4.25 or newer) or jax.tree_util.tree_map (any JAX version).
  total_exp = jax.tree_map(lambda x, y: jnp.concatenate([x, y], axis=1),timestep, shared_exp  )
jaxlib.xla_extension.XlaRuntimeError: INTERNAL: Generated function failed: CpuCallback error: Traceback (most recent call last):
  File "/Applications/PyCharm.app/Contents/plugins/python/helpers/pydev/pydevd.py", line 2199, in <module>
  File "/Applications/PyCharm.app/Contents/plugins/python/helpers/pydev/pydevd.py", line 2181, in main
  File "/Applications/PyCharm.app/Contents/plugins/python/helpers/pydev/pydevd.py", line 1493, in run
  File "/Applications/PyCharm.app/Contents/plugins/python/helpers/pydev/pydevd.py", line 1500, in _exec
  File "/Applications/PyCharm.app/Contents/plugins/python/helpers/pydev/_pydev_imps/_pydev_execfile.py", line 18, in execfile
  File "/Users/enis/Desktop/workspace/projects/SAPIENS_jax/sapiens/sapiens.py", line 755, in <module>
  File "/Users/enis/Desktop/workspace/projects/SAPIENS_jax/sapiens/sapiens.py", line 708, in main
  File "/Users/enis/miniconda3/envs/GrowAI_framework/lib/python3.11/site-packages/jax/_src/traceback_util.py", line 180, in reraise_with_filtered_traceback
  File "/Users/enis/miniconda3/envs/GrowAI_framework/lib/python3.11/site-packages/jax/_src/pjit.py", line 332, in cache_miss
  File "/Users/enis/miniconda3/envs/GrowAI_framework/lib/python3.11/site-packages/jax/_src/pjit.py", line 190, in _python_pjit_helper
  File "/Users/enis/miniconda3/envs/GrowAI_framework/lib/python3.11/site-packages/jax/_src/core.py", line 2739, in bind
  File "/Users/enis/miniconda3/envs/GrowAI_framework/lib/python3.11/site-packages/jax/_src/core.py", line 433, in bind_with_trace
  File "/Users/enis/miniconda3/envs/GrowAI_framework/lib/python3.11/site-packages/jax/_src/core.py", line 939, in process_primitive
  File "/Users/enis/miniconda3/envs/GrowAI_framework/lib/python3.11/site-packages/jax/_src/pjit.py", line 1730, in _pjit_call_impl
  File "/Users/enis/miniconda3/envs/GrowAI_framework/lib/python3.11/site-packages/jax/_src/pjit.py", line 1712, in call_impl_cache_miss
  File "/Users/enis/miniconda3/envs/GrowAI_framework/lib/python3.11/site-packages/jax/_src/pjit.py", line 1666, in _pjit_call_impl_python
  File "/Users/enis/miniconda3/envs/GrowAI_framework/lib/python3.11/site-packages/jax/_src/profiler.py", line 336, in wrapper
  File "/Users/enis/miniconda3/envs/GrowAI_framework/lib/python3.11/site-packages/jax/_src/interpreters/pxla.py", line 1239, in __call__
  File "/Users/enis/miniconda3/envs/GrowAI_framework/lib/python3.11/site-packages/jax/_src/interpreters/mlir.py", line 2656, in _wrapped_callback
  File "/Users/enis/miniconda3/envs/GrowAI_framework/lib/python3.11/site-packages/jax/_src/debugging.py", line 158, in _callback
  File "/Users/enis/miniconda3/envs/GrowAI_framework/lib/python3.11/site-packages/jax/_src/debugging.py", line 88, in debug_callback_impl
  File "/Users/enis/miniconda3/envs/GrowAI_framework/lib/python3.11/site-packages/jax/_src/api.py", line 2489, in device_put
  File "/Users/enis/miniconda3/envs/GrowAI_framework/lib/python3.11/site-packages/jax/_src/core.py", line 429, in bind
  File "/Users/enis/miniconda3/envs/GrowAI_framework/lib/python3.11/site-packages/jax/_src/core.py", line 433, in bind_with_trace
  File "/Users/enis/miniconda3/envs/GrowAI_framework/lib/python3.11/site-packages/jax/_src/core.py", line 939, in process_primitive
  File "/Users/enis/miniconda3/envs/GrowAI_framework/lib/python3.11/site-packages/jax/_src/dispatch.py", line 514, in _batched_device_put_impl
  File "/Users/enis/miniconda3/envs/GrowAI_framework/lib/python3.11/site-packages/jax/_src/profiler.py", line 336, in wrapper
  File "/Users/enis/miniconda3/envs/GrowAI_framework/lib/python3.11/site-packages/jax/_src/interpreters/pxla.py", line 134, in shard_args
  File "/Users/enis/miniconda3/envs/GrowAI_framework/lib/python3.11/site-packages/jax/_src/interpreters/pxla.py", line 158, in _shard_array
  File "/Users/enis/miniconda3/envs/GrowAI_framework/lib/python3.11/functools.py", line 1001, in __get__
  File "/Users/enis/miniconda3/envs/GrowAI_framework/lib/python3.11/site-packages/jax/_src/sharding.py", line 199, in _addressable_device_assignment
  File "/Users/enis/miniconda3/envs/GrowAI_framework/lib/python3.11/site-packages/jax/_src/sharding_impls.py", line 390, in is_fully_addressable
KeyboardInterrupt:
--------------------
