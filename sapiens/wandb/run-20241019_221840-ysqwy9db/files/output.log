/Users/enis/miniconda3/envs/GrowAI_framework/lib/python3.11/site-packages/flashbax/buffers/trajectory_buffer.py:473: UserWarning: Setting max_size dynamically sets the `max_length_time_axis` to be `max_size`//`add_batch_size = 217`.This allows one to control exactly how many timesteps are stored in the buffer.Note that this overrides the `max_length_time_axis` argument.
  warnings.warn(
Traceback (most recent call last):
  File "/Users/enis/Desktop/workspace/projects/SAPIENS_jax/sapiens/sapiens.py", line 764, in <module>
    main(env_name=args.env, num_agents=args.n_agents, connectivity=args.connectivity, trial=args.trial,  local_mode=args.local_mode)
  File "/Users/enis/Desktop/workspace/projects/SAPIENS_jax/sapiens/sapiens.py", line 717, in main
    outs = jax.block_until_ready(train_vjit(rngs))
                                 ^^^^^^^^^^^^^^^^
  File "/Users/enis/miniconda3/envs/GrowAI_framework/lib/python3.11/site-packages/jax/_src/traceback_util.py", line 180, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/enis/miniconda3/envs/GrowAI_framework/lib/python3.11/site-packages/jax/_src/pjit.py", line 332, in cache_miss
    outs, out_flat, out_tree, args_flat, jaxpr, attrs_tracked = _python_pjit_helper(
                                                                ^^^^^^^^^^^^^^^^^^^^
  File "/Users/enis/miniconda3/envs/GrowAI_framework/lib/python3.11/site-packages/jax/_src/pjit.py", line 180, in _python_pjit_helper
    p, args_flat = _infer_params(fun, jit_info, args, kwargs)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/enis/miniconda3/envs/GrowAI_framework/lib/python3.11/site-packages/jax/_src/pjit.py", line 736, in _infer_params
    p, args_flat = _infer_params_impl(
                   ^^^^^^^^^^^^^^^^^^^
  File "/Users/enis/miniconda3/envs/GrowAI_framework/lib/python3.11/site-packages/jax/_src/pjit.py", line 633, in _infer_params_impl
    jaxpr, consts, out_avals, attrs_tracked = _create_pjit_jaxpr(
                                              ^^^^^^^^^^^^^^^^^^^
  File "/Users/enis/miniconda3/envs/GrowAI_framework/lib/python3.11/site-packages/jax/_src/linear_util.py", line 352, in memoized_fun
    ans = call(fun, *args)
          ^^^^^^^^^^^^^^^^
  File "/Users/enis/miniconda3/envs/GrowAI_framework/lib/python3.11/site-packages/jax/_src/pjit.py", line 1277, in _create_pjit_jaxpr
    jaxpr, global_out_avals, consts, attrs_tracked = pe.trace_to_jaxpr_dynamic(
                                                     ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/enis/miniconda3/envs/GrowAI_framework/lib/python3.11/site-packages/jax/_src/profiler.py", line 336, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/enis/miniconda3/envs/GrowAI_framework/lib/python3.11/site-packages/jax/_src/interpreters/partial_eval.py", line 2355, in trace_to_jaxpr_dynamic
    jaxpr, out_avals, consts, attrs_tracked = trace_to_subjaxpr_dynamic(
                                              ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/enis/miniconda3/envs/GrowAI_framework/lib/python3.11/site-packages/jax/_src/interpreters/partial_eval.py", line 2378, in trace_to_subjaxpr_dynamic
    ans = fun.call_wrapped(*in_tracers_)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/enis/miniconda3/envs/GrowAI_framework/lib/python3.11/site-packages/jax/_src/linear_util.py", line 193, in call_wrapped
    ans = self.f(*args, **dict(self.params, **kwargs))
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/enis/miniconda3/envs/GrowAI_framework/lib/python3.11/site-packages/jax/_src/traceback_util.py", line 180, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/enis/miniconda3/envs/GrowAI_framework/lib/python3.11/site-packages/jax/_src/api.py", line 1225, in vmap_f
    out_flat = batching.batch(
               ^^^^^^^^^^^^^^^
  File "/Users/enis/miniconda3/envs/GrowAI_framework/lib/python3.11/site-packages/jax/_src/linear_util.py", line 193, in call_wrapped
    ans = self.f(*args, **dict(self.params, **kwargs))
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/enis/Desktop/workspace/projects/SAPIENS_jax/sapiens/sapiens.py", line 154, in train
    train_states, env_state, init_obs, buffer_states = jax.vmap(init_agent)(agent_keys, agent_ids)
                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/enis/miniconda3/envs/GrowAI_framework/lib/python3.11/site-packages/jax/_src/traceback_util.py", line 180, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/enis/miniconda3/envs/GrowAI_framework/lib/python3.11/site-packages/jax/_src/api.py", line 1225, in vmap_f
    out_flat = batching.batch(
               ^^^^^^^^^^^^^^^
  File "/Users/enis/miniconda3/envs/GrowAI_framework/lib/python3.11/site-packages/jax/_src/linear_util.py", line 193, in call_wrapped
    ans = self.f(*args, **dict(self.params, **kwargs))
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/enis/Desktop/workspace/projects/SAPIENS_jax/sapiens/sapiens.py", line 113, in init_agent
    init_obs, env_state = env.reset(_rng)
                          ^^^^^^^^^^^^^^^
  File "/Users/enis/miniconda3/envs/GrowAI_framework/lib/python3.11/site-packages/jax/_src/traceback_util.py", line 180, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/enis/miniconda3/envs/GrowAI_framework/lib/python3.11/site-packages/jax/_src/pjit.py", line 332, in cache_miss
    outs, out_flat, out_tree, args_flat, jaxpr, attrs_tracked = _python_pjit_helper(
                                                                ^^^^^^^^^^^^^^^^^^^^
  File "/Users/enis/miniconda3/envs/GrowAI_framework/lib/python3.11/site-packages/jax/_src/pjit.py", line 180, in _python_pjit_helper
    p, args_flat = _infer_params(fun, jit_info, args, kwargs)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/enis/miniconda3/envs/GrowAI_framework/lib/python3.11/site-packages/jax/_src/pjit.py", line 736, in _infer_params
    p, args_flat = _infer_params_impl(
                   ^^^^^^^^^^^^^^^^^^^
  File "/Users/enis/miniconda3/envs/GrowAI_framework/lib/python3.11/site-packages/jax/_src/pjit.py", line 633, in _infer_params_impl
    jaxpr, consts, out_avals, attrs_tracked = _create_pjit_jaxpr(
                                              ^^^^^^^^^^^^^^^^^^^
  File "/Users/enis/miniconda3/envs/GrowAI_framework/lib/python3.11/site-packages/jax/_src/linear_util.py", line 352, in memoized_fun
    ans = call(fun, *args)
          ^^^^^^^^^^^^^^^^
  File "/Users/enis/miniconda3/envs/GrowAI_framework/lib/python3.11/site-packages/jax/_src/pjit.py", line 1277, in _create_pjit_jaxpr
    jaxpr, global_out_avals, consts, attrs_tracked = pe.trace_to_jaxpr_dynamic(
                                                     ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/enis/miniconda3/envs/GrowAI_framework/lib/python3.11/site-packages/jax/_src/profiler.py", line 336, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/enis/miniconda3/envs/GrowAI_framework/lib/python3.11/site-packages/jax/_src/interpreters/partial_eval.py", line 2355, in trace_to_jaxpr_dynamic
    jaxpr, out_avals, consts, attrs_tracked = trace_to_subjaxpr_dynamic(
                                              ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/enis/miniconda3/envs/GrowAI_framework/lib/python3.11/site-packages/jax/_src/interpreters/partial_eval.py", line 2378, in trace_to_subjaxpr_dynamic
    ans = fun.call_wrapped(*in_tracers_)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/enis/miniconda3/envs/GrowAI_framework/lib/python3.11/site-packages/jax/_src/linear_util.py", line 193, in call_wrapped
    ans = self.f(*args, **dict(self.params, **kwargs))
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/enis/miniconda3/envs/GrowAI_framework/lib/python3.11/site-packages/gymnax/wrappers/purerl.py", line 84, in reset
    obs, env_state = self._env.reset(key, params)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/enis/miniconda3/envs/GrowAI_framework/lib/python3.11/site-packages/jax/_src/traceback_util.py", line 180, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/enis/miniconda3/envs/GrowAI_framework/lib/python3.11/site-packages/jax/_src/pjit.py", line 332, in cache_miss
    outs, out_flat, out_tree, args_flat, jaxpr, attrs_tracked = _python_pjit_helper(
                                                                ^^^^^^^^^^^^^^^^^^^^
  File "/Users/enis/miniconda3/envs/GrowAI_framework/lib/python3.11/site-packages/jax/_src/pjit.py", line 180, in _python_pjit_helper
    p, args_flat = _infer_params(fun, jit_info, args, kwargs)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/enis/miniconda3/envs/GrowAI_framework/lib/python3.11/site-packages/jax/_src/pjit.py", line 736, in _infer_params
    p, args_flat = _infer_params_impl(
                   ^^^^^^^^^^^^^^^^^^^
  File "/Users/enis/miniconda3/envs/GrowAI_framework/lib/python3.11/site-packages/jax/_src/pjit.py", line 633, in _infer_params_impl
    jaxpr, consts, out_avals, attrs_tracked = _create_pjit_jaxpr(
                                              ^^^^^^^^^^^^^^^^^^^
  File "/Users/enis/miniconda3/envs/GrowAI_framework/lib/python3.11/site-packages/jax/_src/linear_util.py", line 352, in memoized_fun
    ans = call(fun, *args)
          ^^^^^^^^^^^^^^^^
  File "/Users/enis/miniconda3/envs/GrowAI_framework/lib/python3.11/site-packages/jax/_src/pjit.py", line 1277, in _create_pjit_jaxpr
    jaxpr, global_out_avals, consts, attrs_tracked = pe.trace_to_jaxpr_dynamic(
                                                     ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/enis/miniconda3/envs/GrowAI_framework/lib/python3.11/site-packages/jax/_src/profiler.py", line 336, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/enis/miniconda3/envs/GrowAI_framework/lib/python3.11/site-packages/jax/_src/interpreters/partial_eval.py", line 2355, in trace_to_jaxpr_dynamic
    jaxpr, out_avals, consts, attrs_tracked = trace_to_subjaxpr_dynamic(
                                              ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/enis/miniconda3/envs/GrowAI_framework/lib/python3.11/site-packages/jax/_src/interpreters/partial_eval.py", line 2378, in trace_to_subjaxpr_dynamic
    ans = fun.call_wrapped(*in_tracers_)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/enis/miniconda3/envs/GrowAI_framework/lib/python3.11/site-packages/jax/_src/linear_util.py", line 193, in call_wrapped
    ans = self.f(*args, **dict(self.params, **kwargs))
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/enis/miniconda3/envs/GrowAI_framework/lib/python3.11/site-packages/gymnax/wrappers/purerl.py", line 48, in reset
    obs, state = self._env.reset(key, params)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/enis/miniconda3/envs/GrowAI_framework/lib/python3.11/site-packages/gymnax/environments/environment.py", line 62, in reset
    obs, state = self.reset_env(key, params)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/enis/Desktop/workspace/projects/SAPIENS_jax/envs/tiny_alchemy/envs/base.py", line 96, in reset_env
    recipe_book, items = self.build_recipe_book(key, params)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/enis/Desktop/workspace/projects/SAPIENS_jax/envs/tiny_alchemy/envs/bestoften_paths.py", line 80, in build_recipe_book
    return recipe, items
           ^^^^^^
